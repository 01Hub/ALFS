<package name="xml-dtd" version="&xml-dtd-version;">

        <packageinfo>
                <requires><name>libxml2</name></requires>
        	<requires><name>unzip</name></requires>
        </packageinfo>

	<stage name="Unpacking a package.">
	
	        <mkdir>
		        <name>&build_dir;/&xml-dtd-directory;</name>
		</mkdir>

		<unpack>
			<archive>&packages_dir;/&xml-dtd-package;</archive>
			<destination>&build_dir;/&xml-dtd-directory;</destination>
		</unpack>
	</stage>

	<stage name="Installing a package.">
		<stageinfo>
			<base>&build_dir;/&xml-dtd-directory;</base>
		</stageinfo>

		<!-- configuring docbook -->

		<textdump base="/tmp">
		      <file>build_docbook</file>
		      <content>
		      =install -d /usr/share/xml/docbook/xml-dtd-4.2 &amp;&amp;
		      =cp -af docbook.cat *.dtd ent/ *.mod /usr/share/xml/docbook/xml-dtd-4.2 &amp;&amp;
		      =if [ ! -e /etc/xml/catalog ]; then mkdir -p /etc/xml; xmlcatalog --noout \
		      =--create /etc/xml/catalog; fi &amp;&amp;
		      =if [ ! -e /etc/xml/docbook ]; then xmlcatalog --noout --create \
		      =/etc/xml/docbook; fi &amp;&amp;
		      =xmlcatalog --noout --add "public" \
		      ="-//OASIS//ELEMENTS DocBook XML Information Pool V4.2//EN" \
		      ="file:///usr/share/xml/docbook/xml-dtd-4.2/dbpoolx.mod" \
		      =/etc/xml/docbook &amp;&amp;
		      =xmlcatalog --noout --add "public" \
		      ="-//OASIS//DTD DocBook XML V4.2//EN" \
		      ="http://oasis-open.org/docbook/xml/4.2/docbookx.dtd" \
		      =/etc/xml/docbook &amp;&amp;
		      =xmlcatalog --noout --add "public" \
		      ="-//OASIS//ENTITIES DocBook XML Character Entities V4.2//EN" \
		      ="file:///usr/share/xml/docbook/xml-dtd-4.2/dbcentx.mod" \
		      =/etc/xml/docbook &amp;&amp;
		      =xmlcatalog --noout --add "public" \
		      ="-//OASIS//ENTITIES DocBook XML Notations V4.2//EN" \
		      ="file:///usr/share/xml/docbook/xml-dtd-4.2/dbnotnx.mod" \
		      =/etc/xml/docbook &amp;&amp;
		      =xmlcatalog --noout --add "public" \
		      ="-//OASIS//ENTITIES DocBook XML Additional General Entities V4.2//EN" \
		      ="file:///usr/share/xml/docbook/xml-dtd-4.2/dbgenent.mod" \
		      =/etc/xml/docbook &amp;&amp;
		      =xmlcatalog --noout --add "public" \
		      ="-//OASIS//ELEMENTS DocBook XML Document Hierarchy V4.2//EN" \
		      ="file:///usr/share/xml/docbook/xml-dtd-4.2/dbhierx.mod" \
		      =/etc/xml/docbook &amp;&amp;
		      =xmlcatalog --noout --add "public" \
		      ="-//OASIS//DTD XML Exchange Table Model 19990315//EN" \
		      ="file:///usr/share/xml/docbook/xml-dtd-4.2/soextblx.dtd" \
		      =/etc/xml/docbook &amp;&amp;
		      =xmlcatalog --noout --add "public" \
		      ="-//OASIS//DTD DocBook XML CALS Table Model V4.2//EN" \
		      ="file:///usr/share/xml/docbook/xml-dtd-4.2/calstblx.dtd" \
		      =/etc/xml/docbook &amp;&amp;
		      =xmlcatalog --noout --add "rewriteSystem" \
		      ="http://www.oasis-open.org/docbook/xml/4.2" \
		      ="file:///usr/share/xml/docbook/xml-dtd-4.2" \
		      =/etc/xml/docbook &amp;&amp;
		      =xmlcatalog --noout --add "rewriteURI" \
		      ="http://www.oasis-open.org/docbook/xml/4.2" \
		      ="file:///usr/share/xml/docbook/xml-dtd-4.2" \
		      =/etc/xml/docbook &amp;&amp;
		      =xmlcatalog --noout --add "delegatePublic" \
		      ="-//OASIS//ENTITIES DocBook XML" \
		      ="file:///etc/xml/docbook" /etc/xml/catalog &amp;&amp;
		      =xmlcatalog --noout --add "delegatePublic" \
		      ="-//OASIS//DTD DocBook XML" \
		      ="file:///etc/xml/docbook" /etc/xml/catalog &amp;&amp;
		      =xmlcatalog --noout --add "delegateSystem" \
		      ="http://www.oasis-open.org/docbook/" \
		      ="file:///etc/xml/docbook" /etc/xml/catalog &amp;&amp;
		      =xmlcatalog --noout --add "delegateURI" \
		      ="http://www.oasis-open.org/docbook/" \
		      ="file:///etc/xml/docbook" /etc/xml/catalog
		      =
		      =
		      =xmlcatalog --noout --add "delegateSystem" \
		      ="/usr/share/docbook/" \
		      ="file:///etc/xml/docbook" /etc/xml/catalog &amp;&amp;
		      =xmlcatalog --noout --add "delegateURI" \
		      ="/usr/share/docbook/" \
		      ="file:///etc/xml/docbook" /etc/xml/catalog &amp;&amp;
		      =xmlcatalog --noout --add "rewriteSystem" \
		      ="/usr/share/docbook" \
		      ="file:///usr/share/xml/docbook/xml-dtd-4.2" \
		      =/etc/xml/docbook &amp;&amp;
		      =xmlcatalog --noout --add "rewriteURI" \
		      ="/usr/share/docbook" \
		      ="file:///usr/share/xml/docbook/xml-dtd-4.2" \
		      =/etc/xml/docbook
		      =
		      =
		      =xmlcatalog --noout --add "public" \
		      ="-//OASIS//DTD DocBook XML V4.1.2//EN" \
		      ="http://oasis-open.org/docbook/xml/4.1.2/docbookx.dtd" \
		      =/etc/xml/docbook &amp;&amp;
		      =xmlcatalog --noout --add "delegateSystem" \
		      ="http://oasis-open.org/docbook/xml/4.1.2/" \
		      ="file:///etc/xml/docbook" /etc/xml/catalog &amp;&amp;
		      =xmlcatalog --noout --add "delegateURI" \
		      ="http://oasis-open.org/docbook/xml/4.1.2/" \
		      ="file:///etc/xml/docbook" /etc/xml/catalog &amp;&amp;
		      =xmlcatalog --noout --add "rewriteSystem" \
		      ="http://oasis-open.org/docbook/xml/4.1.2" \
		      ="file:///usr/share/xml/docbook/xml-dtd-4.2" \
		      =/etc/xml/docbook &amp;&amp;
		      =xmlcatalog --noout --add "rewriteURI" \
		      ="http://oasis-open.org/docbook/xml/4.1.2" \
		      ="file:///usr/share/xml/docbook/xml-dtd-4.2" \
		      =/etc/xml/docbook
		      </content>
		</textdump>

		<permissions mode="755">
		      <name>/tmp/build_docbook</name>
		</permissions>

		<execute command="/tmp/build_docbook" />

		<remove>/tmp/build_docbook</remove>
	</stage>


	<stage name="Clean-up.">
		<remove>&build_dir;/&xml-dtd-directory;</remove>
	</stage>

</package>
