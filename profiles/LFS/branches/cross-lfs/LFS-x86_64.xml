<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE alfs SYSTEM "DTD/ALFS.dtd"
[

  <!ENTITY % general_entities SYSTEM "config/general.ent">
  <!ENTITY % config_entities SYSTEM "config/config.ent">

  %general_entities;
  %config_entities;
]>
<alfs version="3.1" xmlns:xi="http://www.w3.org/2001/XInclude">
  <stage name="Cross-LFS x86_64">
    <stage name="Preparations">
      <xi:include href="prep/creatingtoolsdir.xml" />
      <xi:include href="prep/addinguser.xml" />
      <xi:include href="prep/settingenvironment.xml" />
      <xi:include href="prep/creatingcrosstoolsdir.xml" />
    </stage>
    <stage name="Creating Cross-Compile Tools">
      <stageinfo>
	<root>/</root>
	<user>&lfs-user;</user>
	<environment>
	  <variable name="LFS">&LFS;</variable>
	  <variable name="LC_ALL">POSIX</variable>
	  <variable name="PATH">/cross-tools/bin:/bin:/usr/bin</variable>
	  <variable name="CFLAGS" />
	  <variable name="CXXFLAGS" />
	  <variable name="TERM">&TERM;</variable>
	  <variable name="HOME">&lfs-user-dir;</variable>
	  <variable name="BUILD32">-m32</variable>
	  <variable name="BUILD64">-m64</variable>
	  <variable name="LFS_HOST">&lfs-host;</variable>
	  <variable name="LFS_TARGET">&lfs-target;</variable>
	  <variable name="LFS_TARGET32">&lfs-target32;</variable>
	</environment>
      </stageinfo>
      <xi:include href="cross-tools/libc-headers.xml" />
      <xi:include href="cross-tools/cross-binutils.xml" />
      <xi:include href="cross-tools/glibc-headers.xml" />
      <xi:include href="cross-tools/cross-gcc-static-libgcc.xml" />
      <xi:include href="cross-tools/glibc-startfiles.xml" />
      <xi:include href="cross-tools/cross-gcc-shared-libgcc.xml" />
      <xi:include href="cross-tools/glibc.xml" />
      <xi:include href="cross-tools/gcc.xml" />
    </stage>
    <stage name="Constructing a Temporary System">
      <stageinfo>
	<root>/</root>
	<user>&lfs-user;</user>
	<environment>
	  <variable name="LFS">&LFS;</variable>
	  <variable name="LC_ALL">POSIX</variable>
	  <variable name="PATH">/cross-tools/bin:/bin:/usr/bin</variable>
	  <variable name="CFLAGS" />
	  <variable name="CXXFLAGS" />
	  <variable name="TERM">&TERM;</variable>
	  <variable name="HOME">&lfs-user-dir;</variable>
	  <variable name="BUILD32">-m32</variable>
	  <variable name="BUILD64">-m64</variable>
	  <variable name="LFS_HOST">&lfs-host;</variable>
	  <variable name="LFS_TARGET">&lfs-target;</variable>
	  <variable name="LFS_TARGET32">&lfs-target32;</variable>
	  <variable name="CC">&lfs-target;-gcc</variable>
	  <variable name="CXX">&lfs-target;-g++</variable>
	  <variable name="AR">&lfs-target;-ar</variable>
	  <variable name="AS">&lfs-target;-as</variable>
	  <variable name="RANLIB">&lfs-target;-ranlib</variable>
	  <variable name="LD">&lfs-target;-ld</variable>
	  <variable name="STRIP">&lfs-target;-strip</variable>
      	</environment>
      </stageinfo>
      <xi:include href="temp-system/binutils.xml" />
      <xi:include href="temp-system/gcc.xml" />
      <xi:include href="temp-system/zlib.xml" />
      <xi:include href="temp-system/gawk.xml" />
      <xi:include href="temp-system/coreutils.xml" />
      <xi:include href="temp-system/bzip2.xml" />
      <xi:include href="temp-system/gzip.xml" />
      <xi:include href="temp-system/diffutils.xml" />
      <xi:include href="temp-system/findutils.xml" />
      <xi:include href="temp-system/make.xml" />
      <xi:include href="temp-system/grep.xml" />
      <xi:include href="temp-system/sed.xml" />
      <xi:include href="temp-system/gettext.xml" />
      <xi:include href="temp-system/ncurses.xml" />
      <xi:include href="temp-system/patch.xml" />
      <xi:include href="temp-system/tar.xml" />
      <xi:include href="temp-system/bash.xml" />
    </stage>
    <stage name="Chroot Prep">
      <stageinfo>
	<root>/</root>
	<environment>
	  <variable name="LFS">&LFS;</variable>
	  <variable name="LC_ALL">POSIX</variable>
	  <variable name="PATH">/cross-tools/bin:/bin:/usr/bin</variable>
	  <variable name="CFLAGS" />
	  <variable name="CXXFLAGS" />
	  <variable name="TERM">&TERM;</variable>
	  <variable name="HOME">&lfs-user-dir;</variable>
	  <variable name="BUILD32">-m32</variable>
	  <variable name="BUILD64">-m64</variable>
	  <variable name="LFS_HOST">&lfs-host;</variable>
	  <variable name="LFS_TARGET">&lfs-target;</variable>
	  <variable name="LFS_TARGET32">&lfs-target32;</variable>
	  <variable name="CC">&lfs-target;-gcc</variable>
	  <variable name="CXX">&lfs-target;-g++</variable>
	  <variable name="AR">&lfs-target;-ar</variable>
	  <variable name="AS">&lfs-target;-as</variable>
	  <variable name="RANLIB">&lfs-target;-ranlib</variable>
	  <variable name="LD">&lfs-target;-ld</variable>
	  <variable name="STRIP">&lfs-target;-strip</variable>
	</environment>
      </stageinfo>
      <xi:include href="chroot/util-linux.xml" />
      <xi:include href="chroot/kernfs.xml" />
    </stage>
    <stage name="Setting up the Chroot Environment">
      <stageinfo>
	<root>&LFS;</root>
	<environment>
	  <variable name="HOME">/root</variable>
	  <variable name="TERM">&TERM;</variable>
	  <variable name="PATH">/bin:/usr/bin:/sbin:/usr/sbin:/tools/bin</variable>
	  <variable name="CFLAGS" />
	  <variable name="CXXFLAGS" />
	</environment>
      </stageinfo>
      <xi:include href="chroot/changingownership.xml" />
      <xi:include href="chroot/creatingdirs.xml" />
      <xi:include href="chroot/creatingsymlinks.xml" />
      <xi:include href="chroot/pwdgroup.xml" />
      <xi:include href="chroot/populate-dev.xml" />
    </stage>
    <stage name="Constructing Temporary Tools">
      <stageinfo>
	<root>&LFS;</root>
	<environment>
	  <variable name="HOME">/root</variable>
	  <variable name="TERM">&TERM;</variable>
	  <variable name="PATH">/bin:/usr/bin:/sbin:/usr/sbin:/tools/bin</variable>
	  <variable name="CFLAGS" />
	  <variable name="CXXFLAGS" />
	  <variable name="BUILD32">-m32</variable>
	  <variable name="BUILD64">-m64</variable>
	  <variable name="LFS_TARGET32">&lfs-target32;</variable>
	</environment>
      </stageinfo>
      <xi:include href="temp-tools/tcl.xml" />
      <xi:include href="temp-tools/expect.xml" />
      <xi:include href="temp-tools/dejagnu.xml" />
      <xi:include href="temp-tools/perl.xml" />
      <xi:include href="temp-tools/texinfo.xml" />
    </stage>
    <stage name="Installing Basic System Software">
      <stageinfo>
	<root>&LFS;</root>
	<environment>
	  <variable name="HOME">/root</variable>
	  <variable name="TERM">&TERM;</variable>
	  <variable name="PATH">/bin:/usr/bin:/sbin:/usr/sbin:/tools/bin</variable>
	  <variable name="CFLAGS" />
	  <variable name="CXXFLAGS" />
	  <variable name="BUILD32">-m32</variable>
	  <variable name="BUILD64">-m64</variable>
	  <variable name="LFS_TARGET32">&lfs-target32;</variable>
	</environment>
      </stageinfo>
      <xi:include href="final-system/libc-headers.xml" />
      <xi:include href="final-system/glibc.xml" />
      <xi:include href="final-system/adjustingtoolchain.xml" />
      <xi:include href="final-system/binutils.xml" />
      <xi:include href="final-system/gcc.xml" />
      <xi:include href="final-system/zlib.xml" />
      <xi:include href="final-system/findutils.xml" />
      <xi:include href="final-system/gawk.xml" />
      <xi:include href="final-system/ncurses.xml" />
      <xi:include href="final-system/readline.xml" />
      <xi:include href="final-system/vim.xml" />
      <xi:include href="final-system/m4.xml" />
      <xi:include href="final-system/bison.xml" />
      <xi:include href="final-system/less.xml" />
      <xi:include href="final-system/groff.xml" />
      <xi:include href="final-system/coreutils.xml" />
      <xi:include href="final-system/sed.xml" />
      <xi:include href="final-system/flex.xml" />
      <xi:include href="final-system/gettext.xml" />
      <xi:include href="final-system/inetutils.xml" />
      <xi:include href="final-system/perl.xml" />
      <xi:include href="final-system/iproute2.xml" />
      <xi:include href="final-system/texinfo.xml" />
      <xi:include href="final-system/autoconf.xml" />
      <xi:include href="final-system/automake.xml" />
      <xi:include href="final-system/bash.xml" />
      <xi:include href="final-system/file.xml" />
      <xi:include href="final-system/libtool.xml" />
      <xi:include href="final-system/bzip2.xml" />
      <xi:include href="final-system/diffutils.xml" />
      <xi:include href="final-system/kbd.xml" />
      <xi:include href="final-system/e2fsprogs.xml" />
      <xi:include href="final-system/grep.xml" />
      <xi:include href="final-system/gzip.xml" />
      <xi:include href="final-system/man.xml" />
      <xi:include href="final-system/man-pages.xml" />
      <xi:include href="final-system/make.xml" />
      <xi:include href="final-system/module-init-tools.xml" />
      <xi:include href="final-system/patch.xml" />
      <xi:include href="final-system/procps.xml" />
      <xi:include href="final-system/psmisc.xml" />
      <xi:include href="final-system/shadow.xml" />
      <xi:include href="final-system/sysklogd.xml" />
      <xi:include href="final-system/sysvinit.xml" />
      <xi:include href="final-system/tar.xml" />
      <xi:include href="final-system/util-linux.xml" />
      <xi:include href="final-system/udev.xml" />
      <xi:include href="final-system/mktemp.xml" />
      <xi:include href="final-system/hotplug.xml" />
      <xi:include href="final-system/iana-etc.xml" />
      <xi:include href="final-system/grub.xml" />
    </stage>
    <stage name="Setting Up System Bootscripts">
      <stageinfo>
	<root>&LFS;</root>
	<environment>
	  <variable name="HOME">/root</variable>
	  <variable name="TERM">&TERM;</variable>
	  <variable name="PATH">/bin:/usr/bin:/sbin:/usr/sbin:/tools/bin</variable>
	  <variable name="CFLAGS" />
	  <variable name="CXXFLAGS" />
	</environment>
      </stageinfo>
      <xi:include href="bootscripts/bootscripts.xml" />
      <xi:include href="bootscripts/setclock.xml" />
      <xi:include href="config/console.xml" />
      <xi:include href="bootscripts/inputrc.xml" />
      <xi:include href="bootscripts/profile.xml" />
      <xi:include href="bootscripts/hostname.xml" />
      <xi:include href="bootscripts/hosts.xml" />
      <xi:include href="bootscripts/network.xml" />
    </stage>
    <stage name="Making the LFS System Bootable">
      <stageinfo>
	<root>&LFS;</root>
	<environment>
	  <variable name="HOME">/root</variable>
	  <variable name="TERM">&TERM;</variable>
	  <variable name="PATH">/bin:/usr/bin:/sbin:/usr/sbin:/tools/bin</variable>
	  <variable name="CFLAGS" />
	  <variable name="CXXFLAGS" />
	</environment>
      </stageinfo>
      <xi:include href="bootable/fstab.xml" />
      <xi:include href="bootable/kernel.xml" />
      <xi:include href="bootable/grub.xml" />
    </stage>
    <stage name="Finishing up (inside chroot)">
      <stageinfo>
	<root>&LFS;</root>
      </stageinfo>
      <remove>/tools</remove>
      <textdump>
	<file>/etc/lfs-release</file>
	<content>=&version;</content>
      </textdump>
    </stage>
    <stage name="Finishing Up (outside chroot)">
      <remove>/tools</remove>
      <execute command="umount">
	<param>&LFS;/dev/pts</param>
	<param>&LFS;/dev/shm</param>
	<param>&LFS;/dev</param>
	<param>&LFS;/proc</param>
	<param>&LFS;/sys</param>
	<!-- If you used a bind mount for your package dir, unmount it here. -->
	<!-- <param>&LFS;&packages_dir;</param> -->
      </execute>
    </stage>
  </stage>
</alfs>

